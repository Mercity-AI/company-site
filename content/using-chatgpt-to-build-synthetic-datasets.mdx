---
title: "Using ChatGPT to build Synthetic Datasets"
slug: using-chatgpt-to-build-synthetic-datasets
publishedAt: "2023-05-19"
createdAt: "2023-05-13"
updatedAt: "2023-05-19"
summary: "In this practical guide you'll learn how to build high quality synthetic datasets using ChatGPT."
authors:
  - name: "Pranav"
category: "Datasets"
image: "https://uploads-ssl.webflow.com/640f56f76d313bbe39631bfd/646741133d82451ca502c79b_synthetic-data-hero.png"
---

<p>Often when solving very specific business problems, it can be challenging to find a large and diverse dataset to train machine learning models.</p><p>Real-world datasets can be costly and time-consuming to collect, and they may not always contain the necessary variety of data to create accurate models. In recent years, the use of synthetic datasets generated by large language models like GPT has become increasingly popular.</p><p>In this article, we will generate a synthetic dataset of complicated sentences and their rewritten simpler versions using GPT models.</p><h2 id="why-use-synthetic-datasets">Why use Synthetic Datasets?</h2><p>Synthetic datasets are computer-generated datasets that can be tailored to specific needs and created quickly and inexpensively compared to collecting and labeling real-world data. This provides businesses with a time-saving and cost-effective solution for training their machine-learning models.</p><p>Synthetic datasets are more diverse and representative than real-world datasets, offering businesses an advantage. Real-world datasets may be limited in their data variety, impacting the accuracy of machine-learning models. Synthetic datasets can be generated with specific properties, such as balanced class distributions, that are hard to achieve in real-world datasets, leading to more accurate models and informed decision-making.</p><p>While synthetic datasets may not be able to fully capture the complexities of real-world data, they are still a powerful tool for businesses to overcome the challenges of collecting real-world data and developing machine-learning models that meet their specific needs.&nbsp;</p><h2 id="how-to-generate-synthetic-data-with-chatgpt">How to Generate Synthetic Data with ChatGPT</h2><p>Models like GPT4 and ChatGPT are usually trained on huge datasets to learn multiple knowledge bases and can do various tasks. We can use this property of LLMs to generate synthetic datasets which are more specific to our needs.</p><p>Now, we can generate synthetic datasets from scratch, it is always better to provide the model with some examples to begin with.</p><p>Let’s discuss the EXACT pipeline we use to generate high-quality synthetic datasets.</p><figure class="w-richtext-figure-type-image w-richtext-align-center" data-rt-type="image" data-rt-align="center"><div><img src="https://uploads-ssl.webflow.com/640f56f76d313bbe39631bfd/645f77cd5e4b02b72cd112f9_33e6e0c1.png" width="auto" height="auto" loading="auto"></div></figure><h3 id="extracting-properties-from-provided-examples">Extracting properties from provided examples</h3><p>The first step is to analyze the examples provided and understand what exactly we are seeking to achieve. This is not required, but we have found that this greatly increases the quality of generated outputs.</p><p>The goal of this step is to generate and understand the key properties of the provided examples. In the synthetic dataset, pairs of inputs and outputs are generated, these properties are the guide for the model to generate them.</p><p>Here’s an example of how to do this:</p><figure class="w-richtext-figure-type-image w-richtext-align-center" data-rt-type="image" data-rt-align="center"><div><img src="https://uploads-ssl.webflow.com/640f56f76d313bbe39631bfd/645f7640c1cf8ec3f58d1d0e_7f2769e3.png" width="auto" height="auto" loading="auto"></div></figure><figure class="w-richtext-figure-type-image w-richtext-align-center" data-rt-type="image" data-rt-align="center"><div><img src="https://uploads-ssl.webflow.com/640f56f76d313bbe39631bfd/645f763e885c34030d6a52a2_09a2a670.png" width="auto" height="auto" loading="auto"></div></figure><h3 id="generating-the-dataset">Generating the dataset</h3><p>Once we have the properties we want our dataset to have, we can begin to generate the synthetic dataset we want. We can tweak the properties if we want, this gives us more control over the generated dataset.</p><p>For this, we usually set the model parameters in a specific way:</p><ul><li><strong>Temperature: </strong>The temperature is usually set to the max value, 1. This is because we want the model to be as “random” as possible, while still staying within the constraints provided, to generate the most diverse dataset possible.</li></ul><ul><li><strong>Frequency Penalty: </strong>This value is also set to a higher number, 1.&nbsp; A higher frequency penalty value will encourage the model to produce more diverse and unique content by penalizing the repetition of the same words or phrases.<br>&nbsp;<strong></strong></li><li><strong>Presence Penalty: </strong>Setting this parameter is a bit tricky. Higher presence penalty that model will be penalized if it generates the same word multiple times. This can be good if you want your dataset to be diverse and contain lots of different words. But if you are generating something very specific, you might want to have the same words present in your dataset multiple times in different contexts. The value of this parameter depends entirely on your requirement.</li></ul><p>You can of course tweak these parameters according to your needs.</p><p>Here’s the prompt to use for this step:</p><figure class="w-richtext-figure-type-image w-richtext-align-center" style="max-width:1572px" data-rt-type="image" data-rt-align="center" data-rt-max-width="1572px"><div><img src="https://uploads-ssl.webflow.com/640f56f76d313bbe39631bfd/645f766e4f8e6541f3528f15_fa176408.png" width="auto" height="auto" loading="auto"></div></figure><div data-rt-embed-type='true'><div style="background-color: #2A2A2B;padding: 2.5%;">

<code>
<i>
Goal is to generate difficult to read and complicated sentences and paraphrase them so they are easy to read and more clear. Use difficult and complicated words in the difficult sentences, and easier to understand words in the paraphrased sentences. The easy to read sentences must be easy to understand, short, should use easy words, and should be on a 5th-grade reading level. 
<br/>
<br/>

Here's an example of such a pair:[{"difficult":"The new legislation, which was passed by a majority of the members of the legislature, will result in a drastic reduction of the number of individuals who are eligible for certain government benefits.","easy":"The lawmakers voted to pass a law that will make it so fewer people can get help from the government."}]

<br/>
<br/>

Some VERY important things:Do not change the meaning of the sentences. Try to only change a few words, and use easier synonyms.Do not change the sentence a lot.Use heavy jargon and very complicated words in difficult sentences.Use easy words in the easy sentences.Difficult sentences should be difficult to parse and follow.Use a formal tone in both sentences. Formal words.All sentences should be very different from each other.

<br/>
<br/>

Important: Sentences must be long and complicatedTopic: legal jargon. Talk about different topics within the given topic.

<br/>
<br/>

JSON with 5 pairs, varying sentences:

</i>
</code>

</div></div><p>You can change the <em>topic</em> according to your needs.</p><p>The prompts are changed to compress the information from the first output, initial testing shows that the results are good enough to work with. But specific usages will require specific changes and prompts will have to be changed accordingly.</p><p>Here’s an example output of the above prompt with the topic set to <em>business administration</em>:</p><figure class="w-richtext-figure-type-image w-richtext-align-center" style="max-width:1570px" data-rt-type="image" data-rt-align="center" data-rt-max-width="1570px"><div><img src="https://uploads-ssl.webflow.com/640f56f76d313bbe39631bfd/645f764d159a448158e297d7_88411663.png" width="auto" height="auto" loading="auto"></div></figure><h3 id="postprocessing-and-storing">Postprocessing and storing</h3><p>Once we have the prompts ready, we can tie everything together and start generating the dataset. We usually ask GPT3 to generate data in a specific format so we can parse and store it. We are going to use the JSON structure in this article as it is very common and is easy to process.</p><p>For this tutorial, we will take the output JSON from GPT3, parse it using python and store it inside a pandas dataframe. After that, we can store it as a CSV.</p><figure class="w-richtext-figure-type-image w-richtext-align-center" data-rt-type="image" data-rt-align="center"><div><img src="https://uploads-ssl.webflow.com/640f56f76d313bbe39631bfd/645f78763a0d8e2c7a306133_bba7e9fe.png" width="auto" height="auto" loading="auto"></div></figure><h2 id="generating-a-synthetic-dataset-of-rephrased-sentences">Generating a Synthetic Dataset of Rephrased Sentences</h2><p>Now that we have the pipeline and the prompts laid out, we can generate the dataset. Here we present an example of generating a dataset of rephrased sentences.</p><h3 id="python-code-to-call-gpt-apis">Python code to call GPT APIs</h3><p>Now we write a python function that calls the GPT APIs and generates the dataset. We will call this function repeatedly with different inputs for the <em>topic</em> parameter to generate sentences with a diverse range of vocabulary.</p><p>Here’s the code:</p><figure class="w-richtext-figure-type-image w-richtext-align-center" data-rt-type="image" data-rt-align="center"><div><img src="https://uploads-ssl.webflow.com/640f56f76d313bbe39631bfd/645f78888d05c01821cdca61_238d3efc.png" width="auto" height="auto" loading="auto"></div></figure><p>In this code, we first load the openai module which allows us to call the GPT APIs, then we load the <em>OPENAI_KEY</em> and set it as the API key to authenticate our requests to OpenAI's GPT service.</p><p>The infer_gpt() function takes two parameters: <em>topic </em>and <em>prompt_version</em>, with a default value of 0 for prompt_version.</p><p>The prompts variable holds a list of different versions of the same prompt. In this case, the <em>tkn_topic_tkn </em>placeholder within the prompt is replaced with the value of the topic parameter, which is the topic we want GPT to generate text about.</p><p>Then, we call the <em>openai.Completion.create()</em> method to generate the sentence pairs.</p><h3 id="calling-the-api-to-generate-the-dataset">Calling the API to generate the dataset</h3><p>Once we have the code to generate the sentences, we can write a loop that will generate them in the context of a specific topic.</p><figure class="w-richtext-figure-type-image w-richtext-align-center" data-rt-type="image" data-rt-align="center"><div><img src="https://uploads-ssl.webflow.com/640f56f76d313bbe39631bfd/645f7648c147b29d6a0fb455_cee3d730.png" width="auto" height="auto" loading="auto"></div></figure><p>In this bit of code, we are looping through our list of <em>topics</em> and calling the <em>infer_gpt</em> for the pased amount of times every single topic in the list.</p><p>Once done, we will have all the data in the <em>df_gpt</em> variable. We can dump that data into a CSV:</p><figure class="w-richtext-figure-type-image w-richtext-align-center" style="max-width:1600px" data-rt-type="image" data-rt-align="center" data-rt-max-width="1600px"><div><img src="https://uploads-ssl.webflow.com/640f56f76d313bbe39631bfd/645f78a3159a448158e45320_6088aca1.png" width="auto" height="auto" loading="auto"></div></figure><p>You can access the data we generated <a href="https://docs.google.com/spreadsheets/d/1TN0Cal-3QnblKIQwGi0hZdm88MW--DwkwkGV3OE5thI/edit?usp=sharing">here</a>.</p><h3 id="exploring-the-dataset">Exploring the Dataset</h3><p>For a dataset on rewritten sentences, this dataset works really well. For rewriting, we wanted a wide vocabulary and a lot of different scenarios where sentences could be rewritten.</p><p>We achieved a wide range of words using the <em>topic</em> parameter, it gave us some control over what kind of words we want to be generated.</p><p>But when it comes to different types of scenarios, this is definitely not a good dataset. All the pairs are of one single sentence rewritten, in real life there might be multiple sentences or even paragraphs that need rewriting. The dataset also lacks variety in the topic of the sentences, this is most likely because of the passed example in the prompt. The generated sentences are all too similar to the given example.</p><h2 id="synthetic-data-vs-real-data">Synthetic Data vs Real Data</h2><p>Synthetic data can indeed help solve a lot of problems in the industry, but it is important to note that synthetic data is always limited by how we are generating it and what underlying model is being used.</p><p>In the above example, the synthetic data is pretty good but is not all that is required to train a model to rephrase sentences. There are many ways a sentence can be simplified, semantically, syntactically, and even by using simple conjunctions. The generated dataset does not contain all these variations. True, these can be generated too, but that requires more work and a new prompt.</p><p>In real data, these variations will be present naturally. Synthetic data alone should not be used to train highly accurate systems, they should only be used to add to the data that is already present. It can also be used to introduce new variations and types to the existing data.</p><h2 id="want-to-build-synthetic-datasets">Want to build synthetic datasets?</h2><p>Looking to build synthetic datasets and train AI models on them? We have worked with synthetic datasets in different fields. We have internal pipelines to ensure the quality of the generated data and experience in using them properly to build and deploy AI systems in production.</p><p>Book a call, let’s help you build your specific dataset!</p>
